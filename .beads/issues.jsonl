{"id":"struct-figma-plugin-2si","title":"Data Application Logic for Local Images","description":"Integrate local image handling into the data application loop.\n\nTasks:\n- [ ] 6.1 Add `isLocalImageFilename` check in main thread's data application loop (line ~890 in code.ts)\n- [ ] 6.2 When value is local filename: extract basename, look up in `localImages`, call `applyImageFromBytes`\n- [ ] 6.3 Log warning and continue when filename not found in `localImages` (missing file scenario)\n- [ ] 6.4 Preserve existing URL image handling unchanged (http:// prefix check comes first)","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:54.853488-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:54.853488-10:00","dependencies":[{"issue_id":"struct-figma-plugin-2si","depends_on_id":"struct-figma-plugin-8fv","type":"blocks","created_at":"2026-01-27T22:35:08.856535-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-2si","depends_on_id":"struct-figma-plugin-doy","type":"blocks","created_at":"2026-01-27T22:35:09.008982-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-4ya","title":"UI State Management for Local Images","description":"Add React state management for storing selected local image files.\n\nTasks:\n- [ ] 2.1 Add `localImageFiles` state in `App.tsx` - type `Record\u003cstring, Map\u003cstring, Uint8Array\u003e\u003e` mapping jsonKey → (filename → bytes)\n- [ ] 2.2 Add `handleLocalImageSelect(jsonKey: string, files: FileList)` callback in `App.tsx` - reads files as ArrayBuffer, converts to Uint8Array, stores in state\n- [ ] 2.3 Add `clearLocalImages(jsonKey: string)` callback in `App.tsx` - removes all images for a mapping\n- [ ] 2.4 Pass `localImageFiles`, `jsonData`, `handleLocalImageSelect`, and `clearLocalImages` as props to KeyMapping component","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:53.132931-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:53.132931-10:00","dependencies":[{"issue_id":"struct-figma-plugin-4ya","depends_on_id":"struct-figma-plugin-751","type":"blocks","created_at":"2026-01-27T22:35:07.318472-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-751","title":"Utility Functions for Local Image Detection","description":"Add utility functions for detecting and processing local image filenames.\n\nTasks:\n- [ ] 1.1 Add `isLocalImageFilename(value: string)` function in `ui/src/utils/index.ts` - returns true if value doesn't start with http:// or https:// AND ends with .png/.jpg/.jpeg/.gif/.webp (case-insensitive)\n- [ ] 1.2 Add `getBasename(path: string)` function in `ui/src/utils/index.ts` - extracts filename from path (handles both / and \\ separators)\n- [ ] 1.3 Add `hasLocalImageValues(jsonData: any[], jsonKey: string)` function in `ui/src/utils/index.ts` - checks if any data values for a key are local image filenames","status":"closed","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:52.775105-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:39:10.452135-10:00","closed_at":"2026-01-27T22:39:10.452135-10:00","close_reason":"Closed"}
{"id":"struct-figma-plugin-7ht","title":"Add applyColorToStroke function","description":"Add applyColorToStroke(node: SceneNode, colorValue: string): boolean function:\n- Check if node has existing strokes before applying\n- Use figma.util.solidPaint() to create SolidPaint\n- Only update stroke color if strokes exist (don't create new strokes)\n- Log success message for stroke application\n- Return true on success, false if no strokes exist","status":"closed","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T18:35:07.028912-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T21:10:04.313581-10:00","closed_at":"2026-01-27T21:10:04.313581-10:00","close_reason":"Implemented applyColorToFill and applyColorToStroke functions using figma.util.solidPaint()","dependencies":[{"issue_id":"struct-figma-plugin-7ht","depends_on_id":"struct-figma-plugin-u71","type":"blocks","created_at":"2026-01-27T18:35:20.572023-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-8fv","title":"Extend Apply Data Message with Local Images","description":"Update the apply-data message to include local image bytes payload.\n\nTasks:\n- [ ] 4.1 Update `apply-data` message handler in `App.tsx` to collect local images from state and include in message payload\n- [ ] 4.2 Convert `Map\u003cstring, Uint8Array\u003e` to `Record\u003cstring, Uint8Array\u003e` for JSON-serializable message format\n- [ ] 4.3 Build combined `localImages` object: `{ [filename]: bytes }` for all selected mappings","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:54.11406-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:54.11406-10:00","dependencies":[{"issue_id":"struct-figma-plugin-8fv","depends_on_id":"struct-figma-plugin-4ya","type":"blocks","created_at":"2026-01-27T22:35:08.185493-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-9je","title":"Add applyColorToFill function","description":"Add applyColorToFill(node: SceneNode, colorValue: string): boolean function:\n- Use figma.util.solidPaint() to create SolidPaint from color string\n- Apply to node.fills if node supports fills\n- Wrap in try-catch for graceful validation failure\n- Log success with layer name and color value\n- Log warning for invalid colors with layer context\n- Return true on success, false on failure","status":"closed","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T18:35:06.478767-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T21:10:04.311438-10:00","closed_at":"2026-01-27T21:10:04.311438-10:00","close_reason":"Implemented applyColorToFill and applyColorToStroke functions using figma.util.solidPaint()","dependencies":[{"issue_id":"struct-figma-plugin-9je","depends_on_id":"struct-figma-plugin-u71","type":"blocks","created_at":"2026-01-27T18:35:20.255892-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-9vz","title":"Create example JSON with color data and manual testing","description":"Testing tasks:\n- Create examples/colors.json with HEX, RGB, HSL color values\n- Manual test: 6-digit HEX (#FF5733) to rectangle fill\n- Manual test: 3-digit shorthand HEX (#F53)\n- Manual test: RGB color to frame background\n- Manual test: HSL color to shape\n- Manual test: Stroke color updates when stroke exists\n- Manual test: No stroke created when none exists\n- Manual test: Invalid color logs warning, continues processing\n- Manual test: URL with hash fragment not treated as color","status":"closed","priority":3,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T18:35:07.694793-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T21:17:19.92258-10:00","closed_at":"2026-01-27T21:17:19.92258-10:00","close_reason":"Created examples/colors.json with comprehensive test cases for HEX, RGB, HSL, invalid colors, and URL edge cases","dependencies":[{"issue_id":"struct-figma-plugin-9vz","depends_on_id":"struct-figma-plugin-hfw","type":"blocks","created_at":"2026-01-27T18:35:21.521841-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-ddd","title":"KeyMapping Component UI for File Picker","description":"Update KeyMapping component to show file picker button for local image mappings.\n\nTasks:\n- [ ] 3.1 Update KeyMapping props interface to accept `localImageFiles`, `jsonData`, `onLocalImageSelect`, and `onClearLocalImages`\n- [ ] 3.2 Add hidden file input with `accept=\"image/png,image/jpeg,image/gif,image/webp\"` and `multiple` attribute\n- [ ] 3.3 Add FolderOpen icon button next to mapping row when `hasLocalImageValues(jsonData, mapping.jsonKey)` returns true\n- [ ] 3.4 Add badge showing file count (e.g., \"5 files\") when images are selected for a mapping\n- [ ] 3.5 Add X button to clear selected images when files are present\n- [ ] 3.6 Style the file picker button consistent with existing Edit/Trash buttons using Figma design tokens","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:53.59302-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:53.59302-10:00","dependencies":[{"issue_id":"struct-figma-plugin-ddd","depends_on_id":"struct-figma-plugin-751","type":"blocks","created_at":"2026-01-27T22:35:07.665938-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-ddd","depends_on_id":"struct-figma-plugin-4ya","type":"blocks","created_at":"2026-01-27T22:35:07.815358-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-doy","title":"Main Thread Image Handling from Bytes","description":"Add function to create Figma images from local file bytes.\n\nTasks:\n- [ ] 5.1 Add `applyImageFromBytes(node: SceneNode, bytes: Uint8Array)` function in `main/code.ts` near `applyImageFromUrl`\n- [ ] 5.2 Implement using `figma.createImage(bytes)` and apply as IMAGE fill (mirror existing URL pattern)\n- [ ] 5.3 Add error handling for invalid image data and log warnings\n- [ ] 5.4 Update message handler for `apply-data` to accept optional `localImages` field","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:54.489216-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:54.489216-10:00","dependencies":[{"issue_id":"struct-figma-plugin-doy","depends_on_id":"struct-figma-plugin-751","type":"blocks","created_at":"2026-01-27T22:35:08.523027-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-hfw","title":"Integrate color detection into applyDataToContainers","description":"Modify applyDataToContainers in main/code.ts to support color mapping:\n- Add color detection check AFTER URL detection but BEFORE text application\n- When color detected, call applyColorToFill() on target layer\n- When color detected AND layer has strokes, also call applyColorToStroke()\n- Skip text application when color is detected (color takes precedence)\n- Maintain existing behavior for URLs, text, images, and variants","status":"closed","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T18:35:07.363331-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T21:11:33.53009-10:00","closed_at":"2026-01-27T21:11:33.53009-10:00","close_reason":"Integrated color detection into applyDataToContainers - checks after URL, applies to fill and stroke","dependencies":[{"issue_id":"struct-figma-plugin-hfw","depends_on_id":"struct-figma-plugin-u71","type":"blocks","created_at":"2026-01-27T18:35:20.997481-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-hfw","depends_on_id":"struct-figma-plugin-9je","type":"blocks","created_at":"2026-01-27T18:35:21.113273-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-hfw","depends_on_id":"struct-figma-plugin-7ht","type":"blocks","created_at":"2026-01-27T18:35:21.236376-10:00","created_by":"Ryan Uesato"}]}
{"id":"struct-figma-plugin-u71","title":"Add color detection utility function (isColorValue)","description":"Add isColorValue(value: string): boolean function to main/code.ts with regex patterns:\n- HEX: /^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$/\n- RGB: /^rgba?\\(\\s*\\d+\\s*,\\s*\\d+\\s*,\\s*\\d+/i\n- HSL: /^hsla?\\(\\s*\\d+/i\n\nReturns true if value matches any color pattern.","status":"closed","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T18:35:06.154076-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T21:07:59.326982-10:00","closed_at":"2026-01-27T21:07:59.326982-10:00","close_reason":"Added isColorValue utility function with HEX, RGB, and HSL pattern detection"}
{"id":"struct-figma-plugin-z30","title":"Testing and Validation for Local Images","description":"Manual testing scenarios to validate local image functionality.\n\nTasks:\n- [ ] 7.1 Test with JSON data containing image filenames (e.g., `{\"image\": \"photo.jpg\"}`)\n- [ ] 7.2 Test file picker appears only for mappings with local image values\n- [ ] 7.3 Test selecting multiple image files and verify count badge updates\n- [ ] 7.4 Test applying data with mixed URLs and local filenames\n- [ ] 7.5 Test missing file warning when data references file not in selection\n- [ ] 7.6 Test clear button removes selected files and hides badge\n- [ ] 7.7 Run `pnpm typecheck` to verify no TypeScript errors","status":"open","priority":2,"issue_type":"task","owner":"ruesato@gmail.com","created_at":"2026-01-27T22:34:55.219019-10:00","created_by":"Ryan Uesato","updated_at":"2026-01-27T22:34:55.219019-10:00","dependencies":[{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-751","type":"blocks","created_at":"2026-01-27T22:35:14.07316-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-4ya","type":"blocks","created_at":"2026-01-27T22:35:14.23635-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-ddd","type":"blocks","created_at":"2026-01-27T22:35:14.399819-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-8fv","type":"blocks","created_at":"2026-01-27T22:35:14.550537-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-doy","type":"blocks","created_at":"2026-01-27T22:35:14.708138-10:00","created_by":"Ryan Uesato"},{"issue_id":"struct-figma-plugin-z30","depends_on_id":"struct-figma-plugin-2si","type":"blocks","created_at":"2026-01-27T22:35:14.865819-10:00","created_by":"Ryan Uesato"}]}
